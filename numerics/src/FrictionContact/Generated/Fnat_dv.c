/*        Generated by TAPENADE     (INRIA, Ecuador team)
    Tapenade 3.12 (r6213) - 13 Oct 2016 10:29
*/
#include "DIFFSIZES.inc"
/*  Hint: NBDirsMax should be the maximum number of differentiation directions
*/

/*
  Differentiation of Fnat in forward (tangent) mode (with options multiDirectional):
   variations   of useful results: *result
   with respect to varying inputs: rt2 un rn ut1 ut2 rt1
   RW status of diff variables: rt2:in *result:out un:in rn:in
                ut1:in ut2:in rt1:in
   Plus diff mem management of: result:in
*/
void Fnat_dv(double mu, double un, double und[NBDirsMax], double ut1, double 
        ut1d[NBDirsMax], double ut2, double ut2d[NBDirsMax], double rn, double
        rnd[NBDirsMax], double rt1, double rt1d[NBDirsMax], double rt2, double
        rt2d[NBDirsMax], double *result, double (*resultd)[NBDirsMax], int 
        nbdirs) {
    double x7;
    double x7d[NBDirsMax];
    double x8;
    double x8d[NBDirsMax];
    double x9;
    double x9d[NBDirsMax];
    double x10;
    double x10d[NBDirsMax];
    double x11;
    double x11d[NBDirsMax];
    double x12;
    double x12d[NBDirsMax];
    double x13;
    double x13d[NBDirsMax];
    int x22;
    int x23;
    double x0;
    double x0d[NBDirsMax];
    double x1;
    double x1d[NBDirsMax];
    double x2;
    double x2d[NBDirsMax];
    double x3;
    double x3d[NBDirsMax];
    double x4;
    double x4d[NBDirsMax];
    double x5;
    double x5d[NBDirsMax];
    double x6;
    double x6d[NBDirsMax];
    double x14;
    double x14d[NBDirsMax];
    double x15;
    double x15d[NBDirsMax];
    double x17;
    double x17d[NBDirsMax];
    double x19;
    double x19d[NBDirsMax];
    double x20;
    double x20d[NBDirsMax];
    double x21;
    double x21d[NBDirsMax];
    double x16;
    double x16d[NBDirsMax];
    double x18;
    double x18d[NBDirsMax];
    double fabs0;
    double fabs0d[NBDirsMax];
    double fabs1;
    double fabs1d[NBDirsMax];
    double fabs2;
    double fabs2d[NBDirsMax];
    double fabs3;
    double fabs3d[NBDirsMax];
    double fabs4;
    double fabs4d[NBDirsMax];
    double fabs5;
    double fabs5d[NBDirsMax];
    int nd;
    double epsilon = 0;
    x7 = mu*ut1;
    x8 = rt1 - x7;
    x9 = x8*x8;
    x10 = mu*ut2;
    x11 = rt2 - x10;
    x12 = x11*x11;
    x13 = x12 + x9;
    x2 = ut1*ut1;
    x3 = ut2*ut2;
    x4 = x2 + x3;
    for (nd = 0; nd < nbdirs; ++nd) {
        x7d[nd] = mu*ut1d[nd];
        x8d[nd] = rt1d[nd] - x7d[nd];
        x9d[nd] = x8d[nd]*x8 + x8*x8d[nd];
        x10d[nd] = mu*ut2d[nd];
        x11d[nd] = rt2d[nd] - x10d[nd];
        x12d[nd] = x11d[nd]*x11 + x11*x11d[nd];
        x13d[nd] = x12d[nd] + x9d[nd];
        x0d[nd] = mu*rnd[nd];
        x1d[nd] = -und[nd];
        x2d[nd] = ut1d[nd]*ut1 + ut1*ut1d[nd];
        x3d[nd] = ut2d[nd]*ut2 + ut2*ut2d[nd];
        x4d[nd] = x2d[nd] + x3d[nd];
        x5d[nd] = (x4 == 0.0 ? 0.0 : x4d[nd]/(2.0*sqrt(x4)));
        x6d[nd] = -(mu*x5d[nd]);
        x14d[nd] = (x13 == 0.0 ? 0.0 : x13d[nd]/(2.0*sqrt(x13)));
    }
    x22 = x13 > epsilon;
    x23 = x13 <= epsilon;
    x0 = mu*rn;
    x1 = -un;
    x5 = sqrt(x4);
    x6 = -mu*x5;
    x14 = sqrt(x13);
    if (0 - x0 + x1 + x14 + x6 >= 0.0) {
        for (nd = 0; nd < nbdirs; ++nd)
            fabs0d[nd] = x1d[nd] - x0d[nd] + x14d[nd] + x6d[nd];
        fabs0 = 0 - x0 + x1 + x14 + x6;
    } else {
        for (nd = 0; nd < nbdirs; ++nd)
            fabs0d[nd] = -(x1d[nd]-x0d[nd]+x14d[nd]+x6d[nd]);
        fabs0 = -(0-x0+x1+x14+x6);
    }
    for (nd = 0; nd < nbdirs; ++nd) {
        x15d[nd] = 0.5*(x0d[nd]+x1d[nd]+x14d[nd]+x6d[nd]+fabs0d[nd]);
        x16d[nd] = -(0.5*x15d[nd]);
    }
    x15 = 0.5*(0+x0+x1+x14+x6+fabs0);
    x16 = -0.5*x15;
    if (0 - x0 + x1 - x14 + x6 >= 0.0) {
        for (nd = 0; nd < nbdirs; ++nd)
            fabs1d[nd] = x1d[nd] - x0d[nd] - x14d[nd] + x6d[nd];
        fabs1 = 0 - x0 + x1 - x14 + x6;
    } else {
        for (nd = 0; nd < nbdirs; ++nd)
            fabs1d[nd] = -(x1d[nd]-x0d[nd]-x14d[nd]+x6d[nd]);
        fabs1 = -(0-x0+x1-x14+x6);
    }
    for (nd = 0; nd < nbdirs; ++nd) {
        x17d[nd] = 0.5*(x0d[nd]+x1d[nd]-x14d[nd]+x6d[nd]+fabs1d[nd]);
        x18d[nd] = 0.5*x17d[nd];
        resultd[0][nd] = x0d[nd] + x16d[nd] - x18d[nd];
    }
    x17 = 0.5*(0+x0+x1-x14+x6+fabs1);
    x18 = 0.5*x17;
    result[0] = x0 + x16 - x18;
    if (x23) {
        x2 = ut1*ut1;
        x3 = ut2*ut2;
        x4 = x2 + x3;
        for (nd = 0; nd < nbdirs; ++nd) {
            x0d[nd] = mu*rnd[nd];
            x1d[nd] = -und[nd];
            x2d[nd] = ut1d[nd]*ut1 + ut1*ut1d[nd];
            x3d[nd] = ut2d[nd]*ut2 + ut2*ut2d[nd];
            x4d[nd] = x2d[nd] + x3d[nd];
            x5d[nd] = (x4 == 0.0 ? 0.0 : x4d[nd]/(2.0*sqrt(x4)));
            x6d[nd] = -(mu*x5d[nd]);
            x14d[nd] = (x13 == 0.0 ? 0.0 : x13d[nd]/(2.0*sqrt(x13)));
        }
        x0 = mu*rn;
        x1 = -un;
        x5 = sqrt(x4);
        x6 = -mu*x5;
        x14 = sqrt(x13);
        if (0 - x0 + x1 + x14 + x6 >= 0.0) {
            for (nd = 0; nd < nbdirs; ++nd)
                fabs2d[nd] = x1d[nd] - x0d[nd] + x14d[nd] + x6d[nd];
            fabs2 = 0 - x0 + x1 + x14 + x6;
        } else {
            for (nd = 0; nd < nbdirs; ++nd)
                fabs2d[nd] = -(x1d[nd]-x0d[nd]+x14d[nd]+x6d[nd]);
            fabs2 = -(0-x0+x1+x14+x6);
        }
        for (nd = 0; nd < nbdirs; ++nd) {
            x15d[nd] = 0.5*(x0d[nd]+x1d[nd]+x14d[nd]+x6d[nd]+fabs2d[nd]);
            x16d[nd] = -(0.5*x15d[nd]);
        }
        x15 = 0.5*(0+x0+x1+x14+x6+fabs2);
        x16 = -0.5*x15;
        if (0 - x0 + x1 - x14 + x6 >= 0.0) {
            for (nd = 0; nd < nbdirs; ++nd)
                fabs3d[nd] = x1d[nd] - x0d[nd] - x14d[nd] + x6d[nd];
            fabs3 = 0 - x0 + x1 - x14 + x6;
        } else {
            for (nd = 0; nd < nbdirs; ++nd)
                fabs3d[nd] = -(x1d[nd]-x0d[nd]-x14d[nd]+x6d[nd]);
            fabs3 = -(0-x0+x1-x14+x6);
        }
        for (nd = 0; nd < nbdirs; ++nd) {
            x17d[nd] = 0.5*(x0d[nd]+x1d[nd]-x14d[nd]+x6d[nd]+fabs3d[nd]);
            x18d[nd] = 0.5*x17d[nd];
            resultd[1][nd] = rt1d[nd];
        }
        x17 = 0.5*(0+x0+x1-x14+x6+fabs3);
        x18 = 0.5*x17;
        result[1] = rt1;
        for (nd = 0; nd < nbdirs; ++nd)
            resultd[2][nd] = rt2d[nd] + x16d[nd] + x18d[nd];
        result[2] = rt2 + x16 + x18;
    } else if (x22) {
        x2 = ut1*ut1;
        x3 = ut2*ut2;
        x4 = x2 + x3;
        for (nd = 0; nd < nbdirs; ++nd) {
            x0d[nd] = mu*rnd[nd];
            x1d[nd] = -und[nd];
            x2d[nd] = ut1d[nd]*ut1 + ut1*ut1d[nd];
            x3d[nd] = ut2d[nd]*ut2 + ut2*ut2d[nd];
            x4d[nd] = x2d[nd] + x3d[nd];
            x5d[nd] = (x4 == 0.0 ? 0.0 : x4d[nd]/(2.0*sqrt(x4)));
            x6d[nd] = -(mu*x5d[nd]);
            x14d[nd] = (x13 == 0.0 ? 0.0 : x13d[nd]/(2.0*sqrt(x13)));
        }
        x0 = mu*rn;
        x1 = -un;
        x5 = sqrt(x4);
        x6 = -mu*x5;
        x14 = sqrt(x13);
        if (0 - x0 + x1 + x14 + x6 >= 0.0) {
            for (nd = 0; nd < nbdirs; ++nd)
                fabs4d[nd] = x1d[nd] - x0d[nd] + x14d[nd] + x6d[nd];
            fabs4 = 0 - x0 + x1 + x14 + x6;
        } else {
            for (nd = 0; nd < nbdirs; ++nd)
                fabs4d[nd] = -(x1d[nd]-x0d[nd]+x14d[nd]+x6d[nd]);
            fabs4 = -(0-x0+x1+x14+x6);
        }
        for (nd = 0; nd < nbdirs; ++nd)
            x15d[nd] = 0.5*(x0d[nd]+x1d[nd]+x14d[nd]+x6d[nd]+fabs4d[nd]);
        x15 = 0.5*(0+x0+x1+x14+x6+fabs4);
        if (0 - x0 + x1 - x14 + x6 >= 0.0) {
            for (nd = 0; nd < nbdirs; ++nd)
                fabs5d[nd] = x1d[nd] - x0d[nd] - x14d[nd] + x6d[nd];
            fabs5 = 0 - x0 + x1 - x14 + x6;
        } else {
            for (nd = 0; nd < nbdirs; ++nd)
                fabs5d[nd] = -(x1d[nd]-x0d[nd]-x14d[nd]+x6d[nd]);
            fabs5 = -(0-x0+x1-x14+x6);
        }
        x17 = 0.5*(0+x0+x1-x14+x6+fabs5);
        x19 = 1.0/x14;
        x20 = 0.5*x15*x19;
        x21 = 0.5*x17*x19;
        for (nd = 0; nd < nbdirs; ++nd) {
            x17d[nd] = 0.5*(x0d[nd]+x1d[nd]-x14d[nd]+x6d[nd]+fabs5d[nd]);
            x19d[nd] = -(x14d[nd]/(x14*x14));
            x20d[nd] = 0.5*(x15d[nd]*x19+x15*x19d[nd]);
            x21d[nd] = 0.5*(x17d[nd]*x19+x17*x19d[nd]);
            resultd[1][nd] = rt1d[nd] - x20d[nd]*x8 - x20*x8d[nd] + x21d[nd]*
                x8 + x21*x8d[nd];
        }
        result[1] = rt1 - x20*x8 + x21*x8;
        for (nd = 0; nd < nbdirs; ++nd)
            resultd[2][nd] = rt2d[nd] - x11d[nd]*x20 - x11*x20d[nd] + x11d[nd]
                *x21 + x11*x21d[nd];
        result[2] = rt2 - x11*x20 + x11*x21;
    }
}
